
编译记录：

https://blog.csdn.net/wyr1849089774/article/details/129907177


# 1.编译前准备

先按照笔记将ubuntu ros anaconda 之类的那一套装好先

ubuntu 20.04

Ceres2.X版本会报错，需要使用Ceres1.14.0版本。按照ceres官网教程安装即可。

ros noetic

# 2. 编译
    cd ~/catkin_ws/src
    git clone https://github.com/HKUST-Aerial-Robotics/VINS-Fusion.git
    cd ../
    catkin_make
    source ~/catkin_ws/devel/setup.bash

会报很多错：

1. 首先，ROS noetic版本中自带的OpenCV4和VINS-mono中需要使用的OpenCV3冲突的问题。修改vins-mono代码兼容opencv4。其实主要修改的是camera_model这个包，幸运的是发现不用修改代码中不兼容的变量，而是可以直接包含缺失的头文件即可。于是参考opencv参考文档查找opencv4中未定义的变量在opencv3中所属的头文件，然后添加到camera_model相应的头文件中顺利解决问题。（到图形界面中的文件夹里寻找相应文件）

在camera_model包中的头文件Chessboard.h中添加
```c++
   #include <opencv2/imgproc/types_c.h>
   #include <opencv2/calib3d/calib3d_c.h>
```
在CameraCalibration.h中添加
```c++
   #include <opencv2/imgproc/types_c.h>
   #include <opencv2/imgproc/imgproc_c.h>
```
2. 编译时遇到报错 `error: ‘CV_FONT_HERSHEY_SIMPLEX’ was not declared in this scope`

解决：根据报错提醒中指出的路径找到相应报错的文件，在文件中搜索`CV_FONT_HERSHEY_SIMPLEX`并替换成`cv::FONT_HERSHEY_SIMPLEX`。

3. 编译时遇到报错 `error: ‘CV_BGR2GRAY’ was not declared in this scope`

解决：根据报错提醒中指出的路径找到相应报错的文件，在文件中搜索`CV_BGR2GRAY`并替换成`cv::COLOR_BGR2GRAY`。

4. 编译时遇到报错 `error: ‘CV_LOAD_IMAGE_GRAYSCALE’ was not declared in this scope`

解决：根据报错提醒中指出的路径找到相应报错的文件，在文件中搜索`CV_LOAD_IMAGE_GRAYSCALE`并替换成`IMREAD_GRAYSCALE`。

5. 还有报错：

```bash
error: ‘IMREAD_GRAYSCALE’ was not declared in this scope; did you mean ‘cv::IMREAD_GRAYSCALE’?
   95 |    imLeft = cv::imread(leftImagePath, IMREAD_GRAYSCALE );
      |                                       ^~~~~~~~~~~~~~~~
      |                                       cv::IMREAD_GRAYSCALE
```

按照提示修改即可

参考链接：

https://blog.csdn.net/wyr1849089774/article/details/129907177

https://blog.csdn.net/xiaojinger_123/article/details/121517771